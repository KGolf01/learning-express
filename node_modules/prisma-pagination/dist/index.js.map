{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["export interface PaginatedResult<T> {\n  data: T[]\n  meta: {\n    total: number\n    lastPage: number\n    currentPage: number\n    perPage: number\n    prev: number | null\n    next: number | null\n  }\n}\n\nexport type PaginateOptions = { page?: number | string, perPage?: number | string }\nexport type PaginateFunction = <T, K>(model: any, args?: K, options?: PaginateOptions) => Promise<PaginatedResult<T>>\n\nexport const createPaginator = (defaultOptions: PaginateOptions): PaginateFunction => {\n  return async (model, args: any = { where: undefined }, options) => {\n    const page = Number(options?.page || defaultOptions?.page) || 1\n    const perPage = Number(options?.perPage || defaultOptions?.perPage) || 10\n    \n    const skip = page > 0 ? perPage * (page - 1) : 0\n    const [total, data] = await Promise.all([\n      model.count({ where: args.where }),\n      model.findMany({\n        ...args,\n        take: perPage,\n        skip,\n      }),\n    ])\n    const lastPage = Math.ceil(total / perPage)\n\n    return {\n      data,\n      meta: {\n        total,\n        lastPage,\n        currentPage: page,\n        perPage,\n        prev: page > 1 ? page - 1 : null,\n        next: page < lastPage ? page + 1 : null,\n      },\n    }\n  }\n}"],"names":["defaultOptions","model","args","options","where","undefined","page","Number","perPage","skip","Promise","all","count","findMany","take","total","data","lastPage","Math","ceil","meta","currentPage","prev","next"],"mappings":"wOAe+B,SAACA,GAC9B,gBAAcC,EAAOC,EAAkCC,YAAlCD,IAAAA,EAAY,CAAEE,WAAOC,QACxC,IAAMC,EAAOC,cAAOJ,SAAAA,EAASG,cAAQN,SAAAA,EAAgBM,QAAS,EACxDE,EAAUD,cAAOJ,SAAAA,EAASK,iBAAWR,SAAAA,EAAgBQ,WAAY,GAEjEC,EAAOH,EAAO,EAAIE,GAAWF,EAAO,GAAK,yBACnBI,QAAQC,IAAI,CACtCV,EAAMW,MAAM,CAAER,MAAOF,EAAKE,QAC1BH,EAAMY,cACDX,GACHY,KAAMN,EACNC,KAAAA,6BALGM,OAAOC,OAQRC,EAAWC,KAAKC,KAAKJ,EAAQP,GAEnC,MAAO,CACLQ,KAAAA,EACAI,KAAM,CACJL,MAAAA,EACAE,SAAAA,EACAI,YAAaf,EACbE,QAAAA,EACAc,KAAMhB,EAAO,EAAIA,EAAO,EAAI,KAC5BiB,KAAMjB,EAAOW,EAAWX,EAAO,EAAI,SAvBzC"}